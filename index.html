<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í•™ëª…/êµ­ëª… ë§ì¶”ê¸°</title>
  <style>
    :root { --bg:#0b1020; --card:#141a2f; --text:#e6e9f0; --muted:#9aa3b2; --accent:#8ab4ff; --right:#3ecf8e; --wrong:#ff6b6b; }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1020,#0f1530);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial,sans-serif;color:var(--text);}
    .wrap{max-width:880px;margin:40px auto;padding:24px}
    .card{background:var(--card);border:1px solid #202847;border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{font-size:28px;margin:0 0 8px}
    .sub{color:var(--muted);margin-bottom:16px}
    .meta{display:flex;gap:12px;flex-wrap:wrap;margin:12px 0 0}
    .pill{border:1px solid #27304a;border-radius:999px;padding:6px 10px;font-size:13px;background:#121833}
    .question{font-size:20px;margin:4px 0 12px}
    .prompt{font-size:24px;font-weight:700;letter-spacing:.2px;word-break:keep-all}
    .grid{display:grid;grid-template-columns:1fr;gap:12px;margin:18px 0}
    @media (min-width:640px){.grid{grid-template-columns:1fr 1fr}}
    .opt{display:flex;align-items:center;gap:10px;border:1px solid #2a3554;background:#0f1631;border-radius:12px;padding:14px 16px;cursor:pointer;transition:transform .06s ease,border-color .2s}
    .opt:hover{transform:translateY(-1px);border-color:#384774}
    .opt input{appearance:none;width:18px;height:18px;border:2px solid #51639a;border-radius:50%;display:inline-block;position:relative}
    .opt[data-selected="true"] input{border-color:var(--accent);}
    .opt[data-selected="true"] input::after{content:"";position:absolute;inset:3px;background:var(--accent);border-radius:50%}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{border:1px solid #2a3554;background:#101739;color:var(--text);padding:12px 16px;border-radius:12px;font-weight:700;cursor:pointer}
    button:disabled{opacity:.55;cursor:not-allowed}
    .btn-accent{border-color:#3a4f86;background:#13204a}
    .hint{color:var(--accent);font-weight:700;margin-left:6px}
    .feedback{margin-top:8px;font-weight:700}
    .ok{color:var(--right)}
    .bad{color:var(--wrong)}
    .footer{margin-top:18px;color:var(--muted);font-size:13px}
    .hidden{display:none}
    .progress{height:6px;background:#1a2240;border-radius:10px;overflow:hidden;margin:12px 0}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,#7aa2ff,#53d2f1)}
    .center{display:flex;align-items:center;justify-content:center;min-height:160px;text-align:center}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:#0e142b;border:1px solid #2a3554;border-radius:8px;padding:2px 6px;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>í•™ëª…/êµ­ëª… ë§ì¶”ê¸°</h1>
      <div class="sub">ì´ <span id="totalQ">31</span>ë¬¸í•­ â€¢ ì¤‘ë³µ ì—†ëŠ” ëœë¤ ì¶œì œ â€¢ <span class="kbd">íŒíŠ¸</span>ëŠ” í•™ëª… ë‘ ë²ˆì§¸ ë‹¨ì–´ì˜ ì²« ê¸€ì</div>
      <div class="meta">
        <div class="pill">ë¬¸í•­ <span id="qIdx">1</span>/<span id="qTotal">31</span></div>
        <div class="pill">ì •ë‹µ <span id="score">0</span>ê°œ</div>
        <div class="pill">ì‹œê°„ <span id="timer">00:00</span></div>
        <div class="pill" id="modePill">ì¶œì œë°©ì‹: <span id="modeLabel">í•™ëª… â†’ êµ­ëª…</span></div>
      </div>
      <div class="progress"><div class="bar" id="bar"></div></div>

      <div id="quiz">
        <div class="question" id="qText"></div>
        <div class="prompt" id="prompt"></div>
        <div class="grid" id="options"></div>
        <div class="btns">
          <button id="hintBtn" class="btn-accent" type="button">íŒíŠ¸ ë³´ê¸°</button>
          <button id="submitBtn" type="button">ì œì¶œ</button>
        </div>
        <div class="feedback" id="feedback"></div>
      </div>

      <div id="done" class="hidden center">
        <div>
          <h2>ì™„ë£Œ!</h2>
          <p>ì´ <b id="doneTotal">31</b>ë¬¸í•­ ì¤‘ <b id="doneScore">0</b>ê°œ ì •ë‹µ</p>
          <p>ì†Œìš” ì‹œê°„ <b id="doneTime">00:00</b></p>
          <div class="btns" style="justify-content:center;margin-top:12px">
            <button id="restartBtn" class="btn-accent" type="button">ë‹¤ì‹œ ì‹œì‘</button>
          </div>
        </div>
      </div>

      <div class="footer">Tip: ì˜µì…˜ì„ ëˆ„ë¥¸ ë’¤ <span class="kbd">ì œì¶œ</span>ì„ ëˆŒëŸ¬ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. ì‹¤ìˆ˜ íƒ­ ë°©ì§€ìš©ìœ¼ë¡œ ì¦‰ì‹œ ì±„ì Â·ì´ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
    </div>
  </div>

  <script type="application/json" id="phyla-data">
[
  {
    "ko": "í•´ë©´ë™ë¬¼ë¬¸",
    "la": "Phylum Porifera"
  },
  {
    "ko": "ìí¬ë™ë¬¼ë¬¸",
    "la": "Phylum Cnidaria"
  },
  {
    "ko": "ìœ ì¦ë™ë¬¼ë¬¸",
    "la": "Phylum Ctenophora"
  },
  {
    "ko": "ì§„ë¬´ì²´ê°•í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Xenacoelomorpha"
  },
  {
    "ko": "í¸í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Platyhelminthes"
  },
  {
    "ko": "ë³µëª¨ë™ë¬¼ë¬¸",
    "la": "Phylum Gastrotricha"
  },
  {
    "ko": "ì•…êµ¬ë™ë¬¼ë¬¸",
    "la": "Phylum Gnathostomulida"
  },
  {
    "ko": "ë¯¸ì•…ë™ë¬¼ë¬¸",
    "la": "Phylum Micrognathozoa"
  },
  {
    "ko": "ìœ¤í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Rotifera"
  },
  {
    "ko": "êµ¬ë‘ë™ë¬¼ë¬¸",
    "la": "Phylum Acanthocephala"
  },
  {
    "ko": "ì¤‘ìƒë™ë¬¼ë¬¸",
    "la": "Phylum Mesozoa"
  },
  {
    "ko": "êµ¬ë¥œë™ë¬¼ë¬¸",
    "la": "Phylum Cycliophora"
  },
  {
    "ko": "ë‚´í•­ë™ë¬¼ë¬¸",
    "la": "Phylum Entoprocta"
  },
  {
    "ko": "íƒœí˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Bryozoa"
  },
  {
    "ko": "ì™„ì¡±ë™ë¬¼ë¬¸",
    "la": "Phylum Brachiopoda"
  },
  {
    "ko": "ì¶”í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Phoronida"
  },
  {
    "ko": "ìœ í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Nemertea"
  },
  {
    "ko": "ì—°ì²´ë™ë¬¼ë¬¸",
    "la": "Phylum Mollusca"
  },
  {
    "ko": "í™˜í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Annelida"
  },
  {
    "ko": "ì„ í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Nematoda"
  },
  {
    "ko": "ìœ ì„ í˜•ë™ë¬¼ë¬¸",
    "la": "Phylum Nematomorpha"
  },
  {
    "ko": "ë™ê°‘ë™ë¬¼ë¬¸",
    "la": "Phylum Loricifera"
  },
  {
    "ko": "ë™ë¬¸ë™ë¬¼ë¬¸",
    "la": "Phylum Kinorhyncha"
  },
  {
    "ko": "ìƒˆì˜ˆë™ë¬¼ë¬¸",
    "la": "Phylum Priapulida"
  },
  {
    "ko": "ì ˆì§€ë™ë¬¼ë¬¸",
    "la": "Phylum Arthropoda"
  },
  {
    "ko": "ìœ ì¡°ë™ë¬¼ë¬¸",
    "la": "Phylum Onychophora"
  },
  {
    "ko": "ì™„ë³´ë™ë¬¼ë¬¸",
    "la": "Phylum Tardigrada"
  },
  {
    "ko": "ëª¨ì•…ë™ë¬¼ë¬¸",
    "la": "Phylum Chaetognatha"
  },
  {
    "ko": "ê·¹í”¼ë™ë¬¼ë¬¸",
    "la": "Phylum Echinodermata"
  },
  {
    "ko": "ë°˜ì‚­ë™ë¬¼ë¬¸",
    "la": "Phylum Hemichordata"
  },
  {
    "ko": "ì²™ì‚­ë™ë¬¼ë¬¸",
    "la": "Phylum Chordata"
  }
]
  </script>

  <script>
    const $ = (s, p=document) => p.querySelector(s);
    const $$ = (s, p=document) => [...p.querySelectorAll(s)];
    const shuffle = (arr) => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
    const mmss = (sec) => {
      const m = Math.floor(sec/60).toString().padStart(2,'0');
      const s = (sec%60).toString().padStart(2,'0');
      return `${m}:${s}`;
    };

    function loadData(){
      const raw = $('#phyla-data').textContent.trim();
      if(!raw){
        alert('ë°ì´í„°(JSON)ê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.');
        return [];
      }
      try{ return JSON.parse(raw); }catch(e){
        alert('JSON íŒŒì‹± ì˜¤ë¥˜: ' + e.message);
        return [];
      }
    }

    let DATA = loadData();
    let items = [];
    let idx = 0;
    let score = 0;
    let seconds = 0; let tHandle = null;

    function makeQuestion(entry){
      const askLatinToKo = Math.random() < 0.5;
      const correct = askLatinToKo ? entry.ko : entry.la;
      let pool = askLatinToKo ? DATA.map(x=>x.ko) : DATA.map(x=>x.la);
      pool = pool.filter(v => v !== correct);
      const distractors = shuffle(pool).slice(0,3);
      const options = shuffle([correct, ...distractors]);
      const qText = askLatinToKo ? 'ë‹¤ìŒ í•™ëª…ì˜ êµ­ëª…ì„ ê³ ë¥´ì„¸ìš”' : 'ë‹¤ìŒ êµ­ëª…ì˜ í•™ëª…ì„ ê³ ë¥´ì„¸ìš”';
      const prompt = askLatinToKo ? entry.la : entry.ko;

      // ğŸ”¹ ìˆ˜ì •ëœ íŒíŠ¸ ë¡œì§
      let hintChar = '';
      if (askLatinToKo) {
        // í•™ëª… â†’ êµ­ëª… ë§íˆê¸° â†’ êµ­ëª…ì˜ ì²« ê¸€ì
        hintChar = entry.ko.charAt(0);
      } else {
        // êµ­ëª… â†’ í•™ëª… ë§íˆê¸° â†’ í•™ëª…ì˜ ë‘ ë²ˆì§¸ ë‹¨ì–´ ì²« ê¸€ì
        const parts = entry.la.trim().split(/\s+/);
        if (parts.length >= 2) hintChar = parts[1].charAt(0);
        else hintChar = parts[0].charAt(0);
      }

      return { askLatinToKo, qText, prompt, options, correct, hintChar, answer: correct };
    }
      const askLatinToKo = Math.random() < 0.5;
      const correct = askLatinToKo ? entry.ko : entry.la;
      let pool = askLatinToKo ? DATA.map(x=>x.ko) : DATA.map(x=>x.la);
      pool = pool.filter(v => v !== correct);
      const distractors = shuffle(pool).slice(0,3);
      const options = shuffle([correct, ...distractors]);
      const qText = askLatinToKo ? 'ë‹¤ìŒ í•™ëª…ì˜ êµ­ëª…ì„ ê³ ë¥´ì„¸ìš”' : 'ë‹¤ìŒ êµ­ëª…ì˜ í•™ëª…ì„ ê³ ë¥´ì„¸ìš”';
      const prompt = askLatinToKo ? entry.la : entry.ko;

      const latin = entry.la;
      const parts = latin.trim().split(/\s+/);
      let hintChar = '';
      if(parts.length >= 2){ hintChar = parts[1].charAt(0) || ''; }
      else if(parts.length === 1){ hintChar = parts[0].charAt(0) || ''; }

      return { askLatinToKo, qText, prompt, options, correct, hintChar, answer: correct };
    }

    function start(){
      if(!Array.isArray(DATA) || DATA.length !== 31){
        alert('ë°ì´í„°ê°€ 31ê°œê°€ ì•„ë‹™ë‹ˆë‹¤. í˜„ì¬ ê°œìˆ˜: ' + (DATA?.length ?? 0));
        return;
      }
      items = shuffle([...DATA]);
      idx = 0; score = 0; seconds = 0; updateTimer();
      if(tHandle) clearInterval(tHandle);
      tHandle = setInterval(()=>{ seconds++; updateTimer(); },1000);
      $('#qTotal').textContent = items.length;
      $('#totalQ').textContent = items.length;
      next(true);
    }

    function updateTimer(){ $('#timer').textContent = mmss(seconds); }
    function setProgress(){ const pct = ((idx)/items.length)*100; $('#bar').style.width = pct + '%'; }

    let current = null; let selected = null; let locked = false;

    function render(){
      if(!current) return;
      $('#qIdx').textContent = idx+1;
      $('#qText').textContent = current.qText;
      $('#prompt').textContent = current.prompt;
      $('#feedback').textContent = '';
      $('#modeLabel').textContent = current.askLatinToKo ? 'í•™ëª… â†’ êµ­ëª…' : 'êµ­ëª… â†’ í•™ëª…';
      const optsWrap = $('#options');
      optsWrap.innerHTML = '';
      selected = null; locked = false;
      current.options.forEach((text,i)=>{
        const lab = document.createElement('label');
        lab.className = 'opt';
        lab.setAttribute('data-selected','false');
        lab.innerHTML = `<input type="radio" name="opt" aria-label="ì„ íƒ ${i+1}"> <span>${text}</span>`;
        lab.addEventListener('click',()=>{
          if(locked) return;
          selected = text;
          $$('.opt').forEach(el=>el.setAttribute('data-selected','false'));
          lab.setAttribute('data-selected','true');
        });
        optsWrap.appendChild(lab);
      });
      setProgress();
    }

    function next(first=false){
      if(idx >= items.length){
        clearInterval(tHandle);
        $('#quiz').classList.add('hidden');
        $('#done').classList.remove('hidden');
        $('#doneTotal').textContent = items.length;
        $('#doneScore').textContent = score;
        $('#doneTime').textContent = mmss(seconds);
        return;
      }
      const entry = items[idx];
      current = makeQuestion(entry);
      render();
      if(!first) window.scrollTo({top:0,behavior:'smooth'});
    }

    $('#hintBtn').addEventListener('click', ()=>{
      if(!current) return;
      const hintText = `íŒíŠ¸: "${current.hintChar}"`;
      const el = document.createElement('span');
      el.className = 'hint';
      el.textContent = hintText;
      const fb = $('#feedback');
      if(!fb.textContent.includes('íŒíŠ¸')){
        fb.textContent = '';
        fb.append(' ', el);
      }
    });

    $('#submitBtn').addEventListener('click', ()=>{
      if(locked) return;
      if(selected == null){ alert('ì„ ì§€ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.'); return; }
      locked = true;
      const ok = selected === current.answer;
      if(ok){ score++; $('#score').textContent = score; }
      $('#feedback').textContent = ok ? 'ì •ë‹µì…ë‹ˆë‹¤!' : `ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µ: ${current.answer}`;
      idx++;
      setTimeout(()=>{ next(); }, 700);
    });

    $('#restartBtn').addEventListener('click', ()=>{
      $('#done').classList.add('hidden');
      $('#quiz').classList.remove('hidden');
      start();
    });

    start();
  </script>
</body>
</html>
